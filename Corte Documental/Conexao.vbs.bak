Public Session, conn, rs ,print

print = z5m1

Function Conexao_SAP(ByVal Transacao)
            Dim Connection, SapGui, Appl, WshShell, proc, Session, SapGuiAuto, ApplicationSAP

            Conexao_SAP = True

            On Error Resume Next
            Set Session = GetObject("SAPGUI").GetScriptingEngine.Children(0).Children(0)
            If Err.Number <> 0 Then
                On Error GoTo 0
                On Error Resume Next

                Set WshShell = CreateObject("WScript.Shell")
                Set proc = WshShell.Exec("C:\Program Files (x86)\SAP\FrontEnd\SAPgui\saplogon.exe")
                WScript.Sleep 5000

                Set SapGui = GetObject("SAPGUI")
                Set Appl = SapGui.GetScriptingEngine
                Set Connection = Appl.OpenConnection("01 [BRF] - SAP ECC Produção -->Logon Automático<---", True)
                Set Session = Connection.Children(0)
            End If

            If Err.Number = 0 Then
                On Error GoTo 0
                On Error Resume Next
                If Not IsObject(ApplicationSAP) Then
                    Set SapGuiAuto = GetObject("SAPGUI")
                    If Err.Number <> 0 Then
                        MsgBox "Sistema SAP - Não encontrado..!"
                        Exit Function
                    End If
                    Set ApplicationSAP = SapGuiAuto.GetScriptingEngine
                    If Err.Number <> 0 Then
                        MsgBox "Sistema SAP - Cancelado..!"
                        Exit Function
                    End If
                End If

                With Session
                    .findById("wnd[0]/tbar[0]/okcd").Text = "/n"
                    .findById("wnd[0]").sendVKey 0
                    .findById("wnd[0]/tbar[0]/okcd").Text = Transacao
                    .findById("wnd[0]").sendVKey 0
                End With
            Else
                Conexao_SAP = False
                MsgBox "SAP não conectado. Tente novamente!"
				Exit Function
            End If
End Function

Sub ConectarBanco()

    Set conn = CreateObject("ADODB.Connection")
    conn.Open "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=BD DadosSistema.mdb;"
    Set rs = CreateObject("ADODB.Recordset")
	
End Sub